"use strict";(self.webpackChunkseata_website=self.webpackChunkseata_website||[]).push([[49730],{99005:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>r,metadata:()=>o,toc:()=>l});var t=n(74848),s=n(28453);const r={title:"Seata Quick Start",description:"Getting started with Seata from scratch, setting up Seata services, and integrating distributed transactions into Java projects.",keywords:["fescar","seata","distributed transaction"],author:"yudaoyuanma",date:"2020/04/19"},i="1. Overview",o={permalink:"/blog/seata-quick-start",editUrl:"https://github.com/apache/incubator-seata-website/blob/docusaurus/i18n/en/docusaurus-plugin-content-blog/seata-quick-start.md",source:"@site/i18n/en/docusaurus-plugin-content-blog/seata-quick-start.md",title:"Seata Quick Start",description:"Getting started with Seata from scratch, setting up Seata services, and integrating distributed transactions into Java projects.",date:"2020-04-19T00:00:00.000Z",formattedDate:"April 19, 2020",tags:[],readingTime:10.675,hasTruncateMarker:!1,authors:[{name:"yudaoyuanma"}],frontMatter:{title:"Seata Quick Start",description:"Getting started with Seata from scratch, setting up Seata services, and integrating distributed transactions into Java projects.",keywords:["fescar","seata","distributed transaction"],author:"yudaoyuanma",date:"2020/04/19"},unlisted:!1,prevItem:{title:"How is distributed transaction realized? In-depth interpretation of Seata's XA mode",permalink:"/blog/seata-xa-introduce"},nextItem:{title:"Seata High Availability Deployment Practice",permalink:"/blog/seata-ha-practice"}},c={authorsImageUrls:[void 0]},l=[{value:"1.1 Four transaction patterns",id:"11-four-transaction-patterns",level:2},{value:"1.2 Three roles",id:"12-three-roles",level:2},{value:"1.3 Framework Support",id:"13-framework-support",level:2},{value:"1.4 Case Scenarios",id:"14-case-scenarios",level:2},{value:"2.1 Download Seata Package",id:"21-download-seata-package",level:2},{value:"2.2 Starting TC Server",id:"22-starting-tc-server",level:2},{value:"3.1 Downloading the Seata package",id:"31-downloading-the-seata-package",level:2},{value:"3.2 Initialising the database",id:"32-initialising-the-database",level:2},{value:"3.3 Setting up to use the Nacos Registry",id:"33-setting-up-to-use-the-nacos-registry",level:2},{value:"3.4 Starting TC Server",id:"34-starting-tc-server",level:2},{value:"4.1 AT mode",id:"41-at-mode",level:2},{value:"4.2 TCC Pattern",id:"42-tcc-pattern",level:2},{value:"4.3 Saga mode",id:"43-saga-mode",level:2},{value:"4.4 XA mode",id:"44-xa-mode",level:2}];function d(e){const a={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:(0,t.jsx)(a.a,{href:"#",children:"1. Overview"})}),"\n",(0,t.jsx)(a.li,{children:(0,t.jsx)(a.a,{href:"#",children:"2. Deploying Standalone TC Server"})}),"\n",(0,t.jsx)(a.li,{children:(0,t.jsx)(a.a,{href:"#",children:"3. Deploying Cluster TC Server"})}),"\n",(0,t.jsx)(a.li,{children:(0,t.jsx)(a.a,{href:"#",children:"4. Accessing Java Applications"})}),"\n"]}),"\n",(0,t.jsxs)(a.p,{children:[(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata",children:"Seata"})," is an open source ",(0,t.jsx)(a.strong,{children:"Ali"})," open source **distributed transaction **solution , is committed to providing high-performance and easy-to-use distributed transaction services ."]}),"\n",(0,t.jsx)(a.h2,{id:"11-four-transaction-patterns",children:"1.1 Four transaction patterns"}),"\n",(0,t.jsxs)(a.p,{children:["Seata aims to create a ",(0,t.jsx)(a.strong,{children:"one-stop"})," solution for distributed transactions, and will eventually provide four transaction modes:"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["AT mode: See the ",(0,t.jsx)(a.a,{href:"/docs/dev/mode/at-mode/",children:'"Seata AT mode"'})," document."]}),"\n",(0,t.jsx)(a.li,{children:"TCC mode: see the Seata TCC mode document (/docs/dev/mode/tcc-mode/)."}),"\n",(0,t.jsxs)(a.li,{children:["Saga mode: see the document ",(0,t.jsx)(a.a,{href:"/docs/dev/mode/saga-mode/",children:'"SEATA Saga mode"'}),"."]}),"\n",(0,t.jsx)(a.li,{children:"XA mode: under development..."}),"\n"]}),"\n",(0,t.jsxs)(a.p,{children:["Currently used ",(0,t.jsx)(a.strong,{children:"popularity"})," situation is: AT > TCC > Saga. therefore, when we learn Seata, we can spend more energy on ",(0,t.jsx)(a.strong,{children:"AT mode"}),", it is best to understand the principle behind the implementation, after all, distributed transaction involves the correctness of the data, the problem needs to be quickly troubleshooting to locate and solve."]}),"\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsxs)(a.p,{children:["Friendly note: specific popularity, friends can choose to look at ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/issues/1246",children:"Wanted: who's using Seata"})," each company registered use."]}),"\n"]}),"\n",(0,t.jsx)(a.h2,{id:"12-three-roles",children:"1.2 Three roles"}),"\n",(0,t.jsx)(a.p,{children:"There are three roles in the architecture of Seata:"}),"\n",(0,t.jsxs)(a.p,{children:["! ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/images/Seata/2017-01-01/02.png",children:"Three Roles"})]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.strong,{children:"TC"})," (Transaction Coordinator) - Transaction Coordinator: maintains the state of global and branch transactions, drives ",(0,t.jsx)(a.strong,{children:"global transactions"})," commit or rollback."]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.strong,{children:"TM"})," (Transaction Manager) - Transaction Manager: defines the scope of a ",(0,t.jsx)(a.strong,{children:"global transaction"}),", starts the global transaction, commits or rolls back the global transaction."]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.strong,{children:"RM"})," (Resource Manager) - Resource Manager: manages the resources processed by the ",(0,t.jsx)(a.strong,{children:"Branch Transaction"}),", talks to the TC to register the branch transaction and report on the status of the branch transaction, and drives the ",(0,t.jsx)(a.strong,{children:"Branch Transaction"})," to commit or rollback."]}),"\n"]}),"\n",(0,t.jsxs)(a.p,{children:["The TC is a separately deployed ",(0,t.jsx)(a.strong,{children:"Server"})," server and the TM and RM are ",(0,t.jsx)(a.strong,{children:"Client"})," clients embedded in the application."]}),"\n",(0,t.jsxs)(a.p,{children:["In Seata, the ",(0,t.jsx)(a.strong,{children:"Lifecycle"})," of a distributed transaction is as follows:"]}),"\n",(0,t.jsxs)(a.p,{children:["! ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/images/Seata/2017-01-01/01.png",children:"Architecture diagram"})]}),"\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsx)(a.p,{children:"Friendly reminder: look at the red ticks added by the carrots."}),"\n"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["The TM requests the TC to open a global transaction. the TC generates a ",(0,t.jsx)(a.strong,{children:"XID"})," as the number of this global transaction."]}),"\n"]}),"\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsxs)(a.p,{children:[(0,t.jsx)(a.strong,{children:"XID"}),", which is propagated through the microservice's invocation chain, is guaranteed to associate multiple microservice sub-transactions together."]}),"\n"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["RM requests the TC to register the local transaction as a branch transaction of the global transaction to be associated via the ",(0,t.jsx)(a.strong,{children:"XID"})," of the global transaction."]}),"\n",(0,t.jsxs)(a.li,{children:["The TM requests the TC to tell the ",(0,t.jsx)(a.strong,{children:"XID"})," whether the corresponding global transaction is to be committed or rolled back."]}),"\n",(0,t.jsxs)(a.li,{children:["TC drives RMs to commit or rollback their own local transactions corresponding to ",(0,t.jsx)(a.strong,{children:"XID"}),"."]}),"\n"]}),"\n",(0,t.jsx)(a.h2,{id:"13-framework-support",children:"1.3 Framework Support"}),"\n",(0,t.jsxs)(a.p,{children:["Seata currently provides support for the major ",(0,t.jsx)(a.strong,{children:"microservices frameworks"}),":"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"Dubbo"}),"\n"]}),"\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsxs)(a.p,{children:["Integration via ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/blob/develop/integration/dubbo/",children:(0,t.jsx)(a.code,{children:"seata-dubbo"})})]}),"\n"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"SOFA-RPC"}),"\n"]}),"\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsxs)(a.p,{children:["integrated via ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/blob/develop/integration/sofa-rpc/",children:(0,t.jsx)(a.code,{children:"seata-sofa-rpc"})})]}),"\n"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"Motan"}),"\n"]}),"\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsxs)(a.p,{children:["Integrated via ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/blob/develop/integration/motan/",children:(0,t.jsx)(a.code,{children:"seata-motan"})})]}),"\n"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"gRPC"}),"\n"]}),"\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsxs)(a.p,{children:["integrated via ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/blob/develop/integration/gprc/",children:(0,t.jsx)(a.code,{children:"seata-grpc"})})]}),"\n"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"Apache HttpClient"}),"\n"]}),"\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsxs)(a.p,{children:["integrated via ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/blob/develop/integration/http/",children:(0,t.jsx)(a.code,{children:"seata-http"})})]}),"\n"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["Spring Cloud OpenFeign","\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsxs)(a.p,{children:["via ",(0,t.jsx)(a.a,{href:"https://github.com/alibaba/spring-cloud-alibaba/blob/master/spring-cloud-alibaba-starters/spring-cloud-starter-alibaba-seata/src/main/java/com/alibaba/cloud/seata/",children:(0,t.jsx)(a.code,{children:"spring-cloud-starter-alibaba-seata"})})," of ",(0,t.jsx)(a.a,{href:"https://github.com/alibaba/spring-cloud-alibaba/blob/master/spring-cloud-alibaba-starters/spring-cloud-starter-alibaba-seata/src/main/java/com/alibaba/cloud/seata/feign/",children:(0,t.jsx)(a.code,{children:"feign"})})," module"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(a.li,{children:["Spring RestTemplate","\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsxs)(a.p,{children:["via ",(0,t.jsx)(a.a,{href:"https://github.com/alibaba/spring-cloud-alibaba/blob/master/spring-cloud-alibaba-starters/spring-cloud-starter-alibaba-seata/src/main/java/com/alibaba/cloud/seata/feign/SeataBeanPostProcessor.java",children:(0,t.jsx)(a.code,{children:"spring-cloud-starter-alibaba-seata"})})," of ",(0,t.jsx)(a.a,{href:"https://github.com/alibaba/spring-cloud-alibaba/blob/master/spring-cloud-alibaba-starters/spring-cloud-starter-alibaba-seata/src/main/java/com/alibaba/cloud/seata/rest/",children:(0,t.jsx)(a.code,{children:"rest"})})," module"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(a.p,{children:"Seata also provides a Starter library for easy integration into Java projects:"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:(0,t.jsx)(a.a,{href:"https://mvnrepository.com/artifact/io.seata/seata-spring-boot-starter",children:(0,t.jsx)(a.code,{children:"seata-spring-boot-starter"})})}),"\n",(0,t.jsx)(a.li,{children:(0,t.jsx)(a.a,{href:"https://mvnrepository.com/artifact/com.alibaba.cloud/spring-cloud-starter-alibaba-seata",children:(0,t.jsx)(a.code,{children:"spring-cloud-starter-alibaba-seata"})})}),"\n"]}),"\n",(0,t.jsxs)(a.p,{children:["Because Seata is based on the ",(0,t.jsx)(a.a,{href:"https://docs.oracle.com/javase/7/docs/api/javax/sql/DataSource.html",children:"DataSource"})," data source for ",(0,t.jsx)(a.strong,{children:"proxy"})," to extend, it naturally provides very good support for mainstream ORM frameworks:"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsx)(a.li,{children:"MyBatis, MyBatis-Plus"}),"\n",(0,t.jsx)(a.li,{children:"JPA, Hibernate"}),"\n"]}),"\n",(0,t.jsx)(a.h2,{id:"14-case-scenarios",children:"1.4 Case Scenarios"}),"\n",(0,t.jsxs)(a.p,{children:["From the registration of ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/issues/1246",children:"Wanted: who's using Seata"}),", Seata has started to land in many teams in China, including many large companies such as DDT and Rhyme. This can be summarised in the figure below:"]}),"\n",(0,t.jsxs)(a.p,{children:["! ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/images/Seata/2017-01-01/03.png",children:"summary chart"})]}),"\n",(0,t.jsxs)(a.p,{children:["In addition, in the ",(0,t.jsx)(a.a,{href:"https://github.com/seata/awesome-seata",children:"awesome-seata"})," warehouse, carrots carrots see the drop and so on the company's landing when the technology to share, or very real and reliable. As shown in the picture below:! ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/images/Seata/2017-01-01/04.png",children:"awesome-seata \u6ef4\u6ef4"})]}),"\n",(0,t.jsx)(a.p,{children:"In terms of the case, Seata is probably the most reliable distributed transaction solution known to date, or at least it is a very good choice to invest in it technically."}),"\n",(0,t.jsx)(a.h1,{id:"2-deploying-a-standalone-tc-server",children:"2. Deploying a Standalone TC Server"}),"\n",(0,t.jsxs)(a.p,{children:["In this subsection, we will learn to deploy a ",(0,t.jsx)(a.strong,{children:"standalone"})," Seata ",(0,t.jsx)(a.strong,{children:"TC"})," Server, which is commonly used for learning or testing purposes, and is not recommended to be deployed in a production environment."]}),"\n",(0,t.jsxs)(a.p,{children:["Because TC needs to record global and branch transactions, it needs corresponding ",(0,t.jsx)(a.strong,{children:"storage"}),". Currently, TC has two storage modes ( ",(0,t.jsx)(a.code,{children:"store.mode"}),"):"]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["file mode: suitable for ",(0,t.jsx)(a.strong,{children:"standalone"})," mode, global transaction session information is read/written in ",(0,t.jsx)(a.strong,{children:"memory"})," and persisted to local file ",(0,t.jsx)(a.code,{children:"root.data"}),", with high performance."]}),"\n",(0,t.jsxs)(a.li,{children:["db mode: suitable for ",(0,t.jsx)(a.strong,{children:"cluster"})," mode, global transaction session information is shared via ",(0,t.jsx)(a.strong,{children:"db"}),", relatively low performance."]}),"\n"]}),"\n",(0,t.jsxs)(a.p,{children:["Obviously, we will adopt the file mode, and finally we deploy the standalone TC Server as shown below: ! ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/images/Seata/2017-01-01/11.png",children:"Standalone TC Server"})]}),"\n",(0,t.jsx)(a.p,{children:"After so much beeping, we start to formally deploy the standalone TC Server, here carrots carrots use macOS system, and Linux, Windows is similar to the friend of the brain to translate."}),"\n",(0,t.jsx)(a.h2,{id:"21-download-seata-package",children:"2.1 Download Seata Package"}),"\n",(0,t.jsxs)(a.p,{children:["Open the ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/releases",children:"Seata download page"}),", and select the version of Seata you want. Here, we choose ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/releases/tag/v1.1.0",children:"v1.1.0"}),", the latest version."]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-Bash",children:"# Create the directory\n$ mkdir -p /Users/yunai/Seata\n$ cd /Users/yunai/Seata\n\n# Download\n$ wget https://github.com/apache/incubator-seata/releases/download/v1.1.0/seata-server-1.1.0.tar.gz\n\n# Extract\n$ tar -zxvf seata-server-1.1.0.tar.gz\n\n# View directory\n$ cd seata\n$ ls -ls\n24 -rw-r--r-- 1 yunai staff 11365 May 13 2019 LICENSE\n0 drwxr-xr-x 4 yunai staff 128 Apr 2 07:46 bin # Executing scripts\n0 drwxr-xr-x 9 yunai staff 288 Feb 19 23:49 conf # configuration file\n0 drwxr-xr-x 138 yunai staff 4416 Apr 2 07:46 lib # seata-*.jar + dependency library\n"})}),"\n",(0,t.jsx)(a.h2,{id:"22-starting-tc-server",children:"2.2 Starting TC Server"}),"\n",(0,t.jsxs)(a.p,{children:["Execute the ",(0,t.jsx)(a.code,{children:"nohup sh bin/seata-server.sh &"})," command to start TC Server in the background. In the ",(0,t.jsx)(a.code,{children:"nohup.out"})," file, we see the following log, which indicates that the startup was successful:"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-Java",children:"# Using File Storage\n2020-04-02 08:36:01.302 INFO [main]io.seata.common.loader.EnhancedServiceLoader.loadFile:247 -load TransactionStoreManager[FILE] extension by class[io.seata.server.store.file.FileTransactionStoreManager]\n2020-04-02 08:36:01.302 INFO [main]io.seata.common.loader.EnhancedServiceLoader.loadFile:247 -load SessionManager[FILE] extension by class [io.seata.server.session.file.FileBasedSessionManager]\n# Started successfully\n2020-04-02 08:36:01.597 INFO [main]io.seata.core.rpc.netty.RpcServerBootstrap.start:155 -Server started ...\n"})}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["In the default configuration, Seata TC Server starts on the ",(0,t.jsx)(a.strong,{children:"8091"})," endpoint."]}),"\n"]}),"\n",(0,t.jsxs)(a.p,{children:["Since we are using file mode, we can see the local file ",(0,t.jsx)(a.code,{children:"root.data"})," for persistence. The command to do this is as follows:"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-Bash",children:"$ ls -ls sessionStore/\ntotal 0\n0 -rw-r--r-- 1 yunai staff 0 Apr 2 08:36 root.data\n"})}),"\n",(0,t.jsxs)(a.p,{children:["As a follow-up, you can read the ",(0,t.jsx)(a.a,{href:"#",children:'"4. Getting Started with Java Applications"'})," subsection to get started with distributed transactions using Seata."]}),"\n",(0,t.jsx)(a.h1,{id:"3-deploying-a-clustered-tc-server",children:"3. Deploying a Clustered TC Server"}),"\n",(0,t.jsxs)(a.p,{children:["In this subsection, we will learn to deploy ",(0,t.jsx)(a.strong,{children:"Cluster"})," Seata ",(0,t.jsx)(a.strong,{children:"TC"})," Server to achieve high availability, a must for production environments. In clustering, multiple Seata TC Servers share global transaction session information through the ",(0,t.jsx)(a.strong,{children:"db"})," database."]}),"\n",(0,t.jsxs)(a.p,{children:["At the same time, each Seata TC Server can register itself to the registry so that applications can get them from the registry. Eventually we deploy the Clustered TC Server as shown below: ! ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/images/Seata/2017-01-01/21.png",children:"Cluster TC Server"})]}),"\n",(0,t.jsxs)(a.p,{children:["Seata TC Server provides integration with all major registries, as shown in the ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/tree/develop/discovery",children:"discovery"})," directory. Considering the increasing popularity of using Nacos as a registry in China, we will use it here."]}),"\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsxs)(a.p,{children:["Friendly note: If you don't know anything about Nacos, you can refer to the ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/Nacos/install/?self",children:'"Nacos Installation and Deployment"'})," article."]}),"\n"]}),"\n",(0,t.jsx)(a.p,{children:"After beeping so much, we start to deploy standalone TC Server formally, here carrots carrots use macOS system, and Linux, Windows is similar to the friend of the brain to translate."}),"\n",(0,t.jsx)(a.h2,{id:"31-downloading-the-seata-package",children:"3.1 Downloading the Seata package"}),"\n",(0,t.jsxs)(a.p,{children:["Open the Seata download page (",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/releases",children:"https://github.com/apache/incubator-seata/releases"}),"), and select the version of Seata you want. Here, we choose ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/releases/tag/v1.1.0",children:"v1.1.0"}),", the latest version."]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-Bash",children:"# Create the directory\n$ mkdir -p /Users/yunai/Seata\n$ cd /Users/yunai/Seata\n\n# Download\n$ wget https://github.com/apache/incubator-seata/releases/download/v1.1.0/seata-server-1.1.0.tar.gz\n\n# Extract\n$ tar -zxvf seata-server-1.1.0.tar.gz\n\n# View directory\n$ cd seata\n$ ls -ls\n24 -rw-r--r-- 1 yunai staff 11365 May 13 2019 LICENSE\n0 drwxr-xr-x 4 yunai staff 128 Apr 2 07:46 bin # Executing scripts\n0 drwxr-xr-x 9 yunai staff 288 Feb 19 23:49 conf # configuration file\n0 drwxr-xr-x 138 yunai staff 4416 Apr 2 07:46 lib # seata-*.jar + dependency library\n"})}),"\n",(0,t.jsx)(a.h2,{id:"32-initialising-the-database",children:"3.2 Initialising the database"}),"\n",(0,t.jsxs)(a.p,{children:["\u2460 Use the ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata/blob/develop/script/server/db/mysql.sql",children:(0,t.jsx)(a.code,{children:"mysql.sql"})})," script to initialise the db database of Seata TC Server. The contents of the script are as follows:"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-SQL",children:"-- -------------------------------- The script used when storeMode is 'db' --------------------------------\n-- the table to store GlobalSession data\nCREATE TABLE IF NOT EXISTS `global_table`\n(\n   `xid`                       VARCHAR(128) NOT NULL,\n   `transaction_id` BIGINT, `status` TINYL\n   `status`                    TINYINT      NOT NULL,\n   `application_id` VARCHAR(32), `transaction_service\n   `transaction_service_group` VARCHAR(32),\n   `transaction_name` VARCHAR(128),\n   `timeout`                   INT,\n   `begin_time`                BIGINT,\n   `application_data` VARCHAR(2000), `gmt_create\n   `gmt_create`                DATETIME,\n   `gmt_modified`              DATETIME,\n   PRIMARY KEY (`xid`),\n   KEY `idx_gmt_modified_status` (`gmt_modified`, `status`),\n   KEY `idx_transaction_id` (`transaction_id`)\n) ENGINE = InnoDB\n DEFAULT CHARSET = utf8.\n\n-- the table to store BranchSession data\nCREATE TABLE IF NOT EXISTS `branch_table`\n(\n   `branch_id` BIGINT NOT NULL, `xid` VARCHARGE\n   `xid`               VARCHAR(128) NOT NULL,\n   `transaction_id`    BIGINT,\n   `resource_group_id` VARCHAR(32), `resource_id` VARCHAR(32), `transaction_id` BIGINT\n   `resource_id`       VARCHAR(256),\n   `branch_type` VARCHAR(8), `status` TINYINT\n   `status`            TINYINT,\n   `client_id` VARCHAR(64), `application_data` TINYINT, `client_id` VARCHAR(64), `application_data` TINYINT\n   `application_data` VARCHAR(2000), `gmt_create\n   `gmt_create`        DATETIME(6),\n   `gmt_modified`      DATETIME(6),\n   PRIMARY KEY (`branch_id`), `branch_id`, `idx_x\n   KEY `idx_xid` (`xid`)\n) ENGINE = InnoDB\n DEFAULT CHARSET = utf8; -- the table to store lock data.\n\n-- the table to store lock data\nCREATE TABLE IF NOT EXISTS `lock_table`\n(\n   `row_key` VARCHAR(128) NOT NULL, `xid` VARCHAR(128) NOT NULL, -- the table to store lock data\n   `xid`            VARCHAR(96),\n   `transaction_id` BIGINT, `branch_id` BIGINT, `branch_id` BIGINT\n   `branch_id` BIGINT NOT NULL,\n   `resource_id`    VARCHAR(256),\n   `table_name`     VARCHAR(32),\n   `pk` VARCHAR(36), `gmt_create` VARCHAR(256), `gmt_create\n   `gmt_create` DATETIME, `gmt_modify` VARCHAR(256), `pk` VARCHAR(36), `gmt_create` DATETIME\n   `gmt_modified`   DATETIME,\n   PRIMARY KEY (`row_key`),\n   KEY `idx_branch_id` (`branch_id`)\n) ENGINE = InnoDB\n DEFAULT CHARSET = utf8.\n"})}),"\n",(0,t.jsxs)(a.p,{children:["In MySQL, create ",(0,t.jsx)(a.code,{children:"seata"})," database and execute the script under it. The final result is as follows: ! ",(0,t.jsxs)(a.a,{href:"http://www.iocoder.cn/images/Seata/2017-01-01/22.png",children:[(0,t.jsx)(a.code,{children:"seata"})," Database - MySQL 5.X"]})]}),"\n",(0,t.jsxs)(a.p,{children:["\u2461 Modify the ",(0,t.jsx)(a.code,{children:"conf/file"})," configuration file to use the db database to share the global transaction session information of Seata TC Server. As shown in the following figure: ! ",(0,t.jsxs)(a.a,{href:"http://www.iocoder.cn/images/Seata/2017-01-01/23.png",children:[(0,t.jsx)(a.code,{children:"conf/file"})," configuration file"]})]}),"\n",(0,t.jsx)(a.p,{children:"\u2462 MySQL8 support"}),"\n",(0,t.jsxs)(a.blockquote,{children:["\n",(0,t.jsx)(a.p,{children:"If your friend is using MySQL version 8.X, you need to see this step. Otherwise, you can just skip it."}),"\n"]}),"\n",(0,t.jsx)(a.p,{children:"Firstly, you need to download the MySQL 8.X JDBC driver, the command line operation is as follows:"}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-Bash",children:"$ cd lib\n$ wget https://repo1.maven.org/maven2/mysql/mysql-connector-java/8.0.19/mysql-connector-java-8.0.19.jar\n"})}),"\n",(0,t.jsxs)(a.p,{children:["Then, modify the ",(0,t.jsx)(a.code,{children:"conf/file"})," configuration file to use the MySQL 8.X JDBC driver. As shown below: ! ",(0,t.jsxs)(a.a,{href:"http://www.iocoder.cn/images/Seata/2017-01-01/24.png",children:[(0,t.jsx)(a.code,{children:"seata"})," database - MySQL 8.X"]})]}),"\n",(0,t.jsx)(a.h2,{id:"33-setting-up-to-use-the-nacos-registry",children:"3.3 Setting up to use the Nacos Registry"}),"\n",(0,t.jsxs)(a.p,{children:["Modify the ",(0,t.jsx)(a.code,{children:"conf/registry.conf"})," configuration file to set up the Nacos registry. As shown in the following figure: ! ",(0,t.jsxs)(a.a,{href:"http://www.iocoder.cn/images/Seata/2017-01-01/25.png",children:[(0,t.jsx)(a.code,{children:"conf/registry.conf"})," configuration file"]})]}),"\n",(0,t.jsx)(a.h2,{id:"34-starting-tc-server",children:"3.4 Starting TC Server"}),"\n",(0,t.jsxs)(a.p,{children:["\u2460 Execute ",(0,t.jsx)(a.code,{children:"nohup sh bin/seata-server.sh -p 18091 -n 1 &"})," command to start ",(0,t.jsx)(a.strong,{children:"the first"})," TC Server in the background."]}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"-p"}),": Port on which Seata TC Server listens."]}),"\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.code,{children:"-n"}),": Server node. In case of multiple TC Servers, it is necessary to differentiate the respective nodes for generating transactionId transaction numbers for different zones to avoid conflicts."]}),"\n"]}),"\n",(0,t.jsxs)(a.p,{children:["In the ",(0,t.jsx)(a.code,{children:"nohup.out"})," file, we see the following log, indicating a successful startup:"]}),"\n",(0,t.jsx)(a.pre,{children:(0,t.jsx)(a.code,{className:"language-Java",children:"# Using DB Stores\n2020-04-05 16:54:12.793 INFO [main]io.seata.common.loader.EnhancedServiceLoader.loadFile:247 -load DataSourceGenerator[dbcp] extension by class[io.seata.server.store.db.DbcpDataSourceGenerator]\nLoading class `com.mysql.jdbc.Driver'. This is deprecated. The new driver class is `com.mysql.cj.jdbc.Driver'. The driver is automatically registered via the SPI and manual loading of the driver class is generally unnecessary.\n2020-04-05 16:54:13.442 INFO [main]io.seata.common.loader.EnhancedServiceLoader.loadFile:247 -load LogStore[DB] extension by class[io. seata.core.store.db.LogStoreDataBaseDAO]\n2020-04-05 16:54:13.442 INFO [main]io.seata.common.loader.EnhancedServiceLoader.loadFile:247 -load TransactionStoreManager[DB] extension by class[io.seata.server.store.db.DatabaseTransactionStoreManager]\n2020-04-05 16:54:13.442 INFO [main]io.seata.common.loader.EnhancedServiceLoader.loadFile:247 -load SessionManager[DB] extension by class[ io.seata.server.session.db.DataBaseSessionManager]\n# Started successfully\n2020-04-05 16:54:13.779 INFO [main]io.seata.core.rpc.netty.RpcServerBootstrap.start:155 -Server started ...\n# Using the Nacos Registry\n2020-04-05 16:54:13.788 INFO [main]io.seata.common.loader.EnhancedServiceLoader.loadFile:247 -load RegistryProvider[Nacos] extension by class[io.seata.discovery.registry.nacos.NacosRegistryProvider]\n"})}),"\n",(0,t.jsxs)(a.p,{children:["\u2461 Execute the ",(0,t.jsx)(a.code,{children:"nohup sh bin/seata-server.sh -p 28091 -n 2 &"})," command to start the ",(0,t.jsx)(a.strong,{children:"second"})," TC Server in the background."]}),"\n",(0,t.jsxs)(a.p,{children:["\u2462 Open the Nacos Registry console and we can see that there are ",(0,t.jsx)(a.strong,{children:"two"})," Seata TC Server examples. As shown in the following figure: ! ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/images/Seata/2017-01-01/26.png",children:"Nacos console"})]}),"\n",(0,t.jsx)(a.h1,{id:"4-accessing-java-applications",children:"4. Accessing Java Applications"}),"\n",(0,t.jsx)(a.h2,{id:"41-at-mode",children:"4.1 AT mode"}),"\n",(0,t.jsxs)(a.p,{children:[(0,t.jsx)(a.strong,{children:"\u2460 Spring Boot"}),"."]}),"\n",(0,t.jsxs)(a.ol,{children:["\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.a,{href:"#",children:'"2. AT Mode + Multiple Data Sources"'})," subsection of ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/Spring-Boot/Seata/?self",children:'"Getting Started with Taro Road Spring Boot Distributed Transaction Seata"'})," implements distributed transactions for a single Spring Boot project under multiple data sources."]}),"\n"]}),"\n",(0,t.jsxs)(a.p,{children:["! ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/images/Spring-Boot/2020-10-01/01.png",children:"Overall diagram"})]}),"\n",(0,t.jsxs)(a.ol,{start:"2",children:["\n",(0,t.jsxs)(a.li,{children:[(0,t.jsx)(a.a,{href:"#",children:'"AT Pattern + HttpClient Remote Call"'})," subsection of ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/Spring-Boot/Seata/?self",children:'"Getting Started with Taro Road Spring Boot Distributed Transaction Seata"'}),", to implement distributed transactions for multiple Spring Boot projects."]}),"\n"]}),"\n",(0,t.jsxs)(a.p,{children:["! ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/images/Spring-Boot/2020-10-01/21.png",children:"Overall diagram"})]}),"\n",(0,t.jsx)(a.p,{children:(0,t.jsx)(a.strong,{children:"\u2461 Dubbo"})}),"\n",(0,t.jsxs)(a.p,{children:["Subsection ",(0,t.jsx)(a.a,{href:"#",children:'"2. AT Patterns"'})," of ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/Dubbo/Seata/?sef",children:'"Getting Started with Dubbo Distributed Transaction Seata"'})," implements distributed transactions under multiple Dubbo services."]}),"\n",(0,t.jsxs)(a.p,{children:["! ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/images/Dubbo/2020-04-15/01.png",children:"Overall Diagram"})]}),"\n",(0,t.jsx)(a.p,{children:(0,t.jsx)(a.strong,{children:"\u2462 Spring Cloud"})}),"\n",(0,t.jsxs)(a.p,{children:["The ",(0,t.jsx)(a.a,{href:"#",children:'"3. AT Patterns + Feign"'})," subsection of ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/Spring-Cloud-Alibaba/Seata/?self",children:'"Getting Started with Alibaba Distributed Transaction Seata for Taro Road Spring Cloud"'})," implements multiple Spring Cloud services."]}),"\n",(0,t.jsxs)(a.p,{children:["! ",(0,t.jsx)(a.a,{href:"http://www.iocoder.cn/images/Spring-Cloud/2020-07-15/01.png",children:"Overall diagram"})]}),"\n",(0,t.jsx)(a.h2,{id:"42-tcc-pattern",children:"4.2 TCC Pattern"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["Documentation: ",(0,t.jsx)(a.a,{href:"/docs/dev/mode/tcc-mode/",children:'"Seata Documentation -- TCC Mode"'})]}),"\n",(0,t.jsxs)(a.li,{children:["Example: ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata-samples/blob/master/tcc",children:"https://github.com/apache/incubator-seata-samples/blob/master/tcc"})]}),"\n"]}),"\n",(0,t.jsx)(a.h2,{id:"43-saga-mode",children:"4.3 Saga mode"}),"\n",(0,t.jsxs)(a.ul,{children:["\n",(0,t.jsxs)(a.li,{children:["Documentation: ",(0,t.jsx)(a.a,{href:"/docs/dev/mode/saga-mode/",children:'"Seata Documentation -- Saga Mode"'})]}),"\n",(0,t.jsxs)(a.li,{children:["Example: ",(0,t.jsx)(a.a,{href:"https://github.com/apache/incubator-seata-samples/tree/master/saga",children:"https://github.com/apache/incubator-seata-samples/tree/master/saga"})]}),"\n"]}),"\n",(0,t.jsx)(a.h2,{id:"44-xa-mode",children:"4.4 XA mode"}),"\n",(0,t.jsx)(a.p,{children:"Seata is under development..."})]})}function h(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,t.jsx)(a,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,a,n)=>{n.d(a,{R:()=>i,x:()=>o});var t=n(96540);const s={},r=t.createContext(s);function i(e){const a=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),t.createElement(r.Provider,{value:a},e.children)}}}]);